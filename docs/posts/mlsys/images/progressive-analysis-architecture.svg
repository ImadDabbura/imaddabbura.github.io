<svg viewBox="0 0 700 500" xmlns="http://www.w3.org/2000/svg">
  <!-- Title -->
  <text x="350" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold">Progressive Analysis Architecture</text>
  
  <!-- Funnel shape -->
  <path d="M 95 60 L 600 60 L 470 390 L 230 390 Z" fill="#E3F2FD" stroke="#1976D2" stroke-width="2"/>
  
  <!-- Tier 1: Wire-speed Triage -->
  <rect x="128" y="65" width="440" height="70" fill="#4CAF50" fill-opacity="0.8" rx="5"/>
  <text x="130" y="85" font-size="14" font-weight="bold" fill="white">Tier-1: Wire-speed Triage (100K rec/s)</text>
  <text x="135" y="105" font-size="11" fill="white">• 5 features: src_reputation, dst_port, protocol, packet_rate, byte_rate</text>
  <text x="135" y="120" font-size="11" fill="white">• Lightweight model (logistic regression)</text>
  <text x="506" y="95" font-size="12" fill="white" font-weight="bold">70% exits</text>
  <text x="520" y="110" font-size="10" fill="white">(benign)</text>
  
  <!-- Tier 2: Fast Analysis -->
  <rect x="170" y="160" width="360" height="60" fill="#FF9800" fill-opacity="0.8" rx="5"/>
  <text x="180" y="178" font-size="14" font-weight="bold" fill="white">Tier-2: Fast Analysis (30K rec/s)</text>
  <text x="185" y="195" font-size="11" fill="white">• 25 features: windowed stats, counts, uniques</text>
  <text x="185" y="210" font-size="11" fill="white">• Gradient boosting model</text>
  <text x="450" y="185" font-size="12" fill="white" font-weight="bold">25% exits</text>
  <text x="465" y="200" font-size="10" fill="white">(normal)</text>
  
  <!-- Tier 3: Deep Analysis -->
  <rect x="200" y="240" width="300" height="60" fill="#F44336" fill-opacity="0.8" rx="5"/>
  <text x="210" y="260" font-size="14" font-weight="bold" fill="white">Tier-3: Deep Analysis (5K rec/s)</text>
  <text x="215" y="275" font-size="11" fill="white">• 100 features: behavioral, historical</text>
  <text x="215" y="290" font-size="11" fill="white">• Neural network</text>
  <text x="450" y="270" font-size="12" fill="white" font-weight="bold">4%</text>
  <text x="430" y="285" font-size="10" fill="white">(suspicious)</text>
  
  <!-- Forensic: Full Analysis -->
  <rect x="230" y="325" width="240" height="50" fill="#9C27B0" fill-opacity="0.8" rx="5"/>
  <text x="300" y="340" text-anchor="middle" font-size="13" font-weight="bold" fill="white">Forensic (500 rec/s)</text>
  <text x="305" y="355" text-anchor="middle" font-size="10" fill="white">• All features + enrichment</text>
  <text x="430" y="345" text-anchor="middle" font-size="10" fill="white">1% high-risk</text>
  
  <!-- Exit arrows -->
  <path d="M 567 125 L 620 125 L 620 150" stroke="#4CAF50" stroke-width="2" fill="none" marker-end="url(#arrow-green)"/>
  <text x="625" y="160" font-size="11" fill="#4CAF50">Benign</text>
  
  <path d="M 530 215 L 620 215 L 620 240" stroke="#FF9800" stroke-width="2" fill="none" marker-end="url(#arrow-orange)"/>
  <text x="625" y="245" font-size="11" fill="#FF9800">Normal</text>
  
  <path d="M 500 285 L 620 285 L 620 310" stroke="#F44336" stroke-width="2" fill="none" marker-end="url(#arrow-red)"/>
  <text x="625" y="315" font-size="11" fill="#F44336">Alert</text>
  
  <path d="M 470 355 L 620 355 L 620 380" stroke="#9C27B0" stroke-width="2" fill="none" marker-end="url(#arrow-purple)"/>
  <text x="625" y="390" font-size="11" fill="#9C27B0">Critical Alert</text>
  
  <!-- Cache boundaries -->
  <line x1="130" y1="145" x2="570" y2="145" stroke="#2196F3" stroke-width="1" stroke-dasharray="5,5"/>
  <text x="135" y="156" font-size="9" fill="#2196F3">Cache boundary</text>
  
  <line x1="162" y1="225" x2="538" y2="225" stroke="#2196F3" stroke-width="1" stroke-dasharray="5,5"/>
  <text x="168" y="235" font-size="9" fill="#2196F3">Cache boundary</text>
  
  <line x1="197" y1="310" x2="505" y2="310" stroke="#2196F3" stroke-width="1" stroke-dasharray="5,5"/>
  <text x="203" y="320" font-size="9" fill="#2196F3">Cache boundary</text>
  
  <!-- Key metrics -->
  <rect x="50" y="440" width="600" height="40" fill="#ECEFF1" rx="5"/>
  <text x="70" y="460" font-size="12" font-weight="bold" fill="#333">Results:</text>
  <text x="150" y="460" font-size="11" fill="#333">96% detection rate</text>
  <text x="280" y="460" font-size="11" fill="#333">95K rec/s throughput</text>
  <text x="410" y="460" font-size="11" fill="#333">8 alerts/day</text>
  <text x="510" y="460" font-size="11" fill="#333">4 servers total</text>
  
  <!-- Arrow markers -->
  <defs>
    <marker id="arrow-green" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <path d="M0,0 L0,6 L9,3 z" fill="#4CAF50"/>
    </marker>
    <marker id="arrow-orange" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <path d="M0,0 L0,6 L9,3 z" fill="#FF9800"/>
    </marker>
    <marker id="arrow-red" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <path d="M0,0 L0,6 L9,3 z" fill="#F44336"/>
    </marker>
    <marker id="arrow-purple" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <path d="M0,0 L0,6 L9,3 z" fill="#9C27B0"/>
    </marker>
  </defs>
</svg>
